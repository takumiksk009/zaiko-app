<!DOCTYPE html>

<html lang="ja">
<head>
<meta charset="utf-8"/>
<title>åœ¨åº«ç®¡ç†ã‚µãƒ³ãƒ—ãƒ«ï¼ˆFirebaseå¯¾å¿œï¼‰</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<style>
    body { font-family: sans-serif; background: #f5f5f5; padding: 20px; color: #2c3e50; }
    h1 { text-align: center; }
    .section { margin-bottom: 40px; }
    input, button, select {
      padding: 8px; margin: 4px 0; font-size: 14px; width: 100%;
    }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #3498db; color: white; }
    .actions button { margin: 0 4px; }
    .tab { margin-bottom: 10px; }
    .tab button { padding: 10px; margin-right: 5px; }
    .hidden { display: none; }
  
/* âœ… ã‚¹ãƒãƒ›ã§ã‚‚è¦‹ã‚„ã™ããªã‚‹ãƒ•ã‚©ãƒ¼ãƒ æ‹¡å¤§ã¨æ•´åˆ— */
form, .section {
  max-width: 800px;
  margin: 0 auto;
  padding: 20px;
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
}
input, select, button {
  padding: 14px;
  font-size: 16px;
  margin-bottom: 12px;
  border-radius: 8px;
  border: 1px solid #ccc;
  width: 100%;
  box-sizing: border-box;
}
button {
  background: #3498db;
  color: white;
  font-weight: bold;
}
button:hover {
  opacity: 0.9;
}
@media (max-width: 600px) {
  h1, h2 {
    font-size: 22px;
  }
  input, select, button {
    font-size: 18px;
  }
}

/* âœ… ãƒ†ãƒ¼ãƒ–ãƒ«æ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯¾å¿œï¼ˆã‚¹ãƒãƒ›æœ€é©åŒ–ï¼‰ */
@media (max-width: 768px) {
  .table-scroll {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }
  table {
    min-width: 700px;
  }
}
th, td {
  font-size: 15px;
  padding: 10px;
}
</style>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js">
    const tempOrders = [];

    function addInventory() {
      const newItem = {
        user: document.getElementById('user').value,
        maker: document.getElementById('maker').value,
        category: document.getElementById('category').value,
        model: document.getElementById('model').value,
        qty: parseInt(document.getElementById('qty').value) || 0,
        site: document.getElementById('site').value,
        date: document.getElementById('date').value,
        remaining: parseInt(document.getElementById('qty').value) || 0,
        timestamp: Date.now()
      };
      tempOrders.push(newItem);
      renderOrderList();
      alert("æ³¨æ–‡ãƒªã‚¹ãƒˆã«è¿½åŠ ã—ã¾ã—ãŸï¼");
      document.querySelectorAll('#register input').forEach(el => el.value = "");
    }

    function renderOrderList() {
      const container = document.getElementById("orderListContainer");
      if (!container) return;

      if (tempOrders.length === 0) {
        container.innerHTML = "<p>ç¾åœ¨ã€æ³¨æ–‡æ¸ˆã¿ãƒªã‚¹ãƒˆã¯ç©ºã§ã™ã€‚</p>";
        return;
      }

      let html = "<table><thead><tr><th>ç™»éŒ²è€…</th><th>ãƒ¡ãƒ¼ã‚«ãƒ¼</th><th>ã‚«ãƒ†ã‚´ãƒª</th><th>å‹å¼</th><th>å€‹æ•°</th><th>ç¾å ´å</th><th>æ³¨æ–‡æ—¥</th><th>æ“ä½œ</th></tr></thead><tbody>";
    for (const key in data) {
      const item = data[key];
      const item_json = JSON.stringify(item).replace(/"/g, '&quot;');
      html += `<tr>
        <td>${item.user}</td>
        <td>${item.maker}</td>
        <td>${item.category}</td>
        <td>${item.model}</td>
        <td>${item.qty}</td>
        <td>${item.site}</td>
        <td>${item.date}</td>
        <td>
          <button onclick="confirmOrderFromFirebase('${key}', ${item_json})">ç™»éŒ²</button><br>
          <button onclick="sendToOrderFormFromFirebase(${item_json})">æ³¨æ–‡æ›¸ç™ºè¡Œ</button><br>
          <button onclick="deleteOrderFromFirebase('${key}')">å‰Šé™¤</button>
        </td>
      </tr>`;
    }
    html += "</tbody></table>";
    container.innerHTML = html;
    }

    function confirmOrder(index) {
      const item = tempOrders[index];
      dbRef.push(item);
      tempOrders.splice(index, 1);
      renderOrderList();
      alert("åœ¨åº«ã«ç™»éŒ²ã•ã‚Œã¾ã—ãŸï¼");
    }


function sendToOrderForm(index) {
  const item = tempOrders[index];
  localStorage.setItem("rinnaiOrderItem", JSON.stringify(item));
  window.location.href = "rinnai_order_form.html";
}

</script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js">
    const tempOrders = [];

    function addInventory() {
      const newItem = {
        user: document.getElementById('user').value,
        maker: document.getElementById('maker').value,
        category: document.getElementById('category').value,
        model: document.getElementById('model').value,
        qty: parseInt(document.getElementById('qty').value) || 0,
        site: document.getElementById('site').value,
        date: document.getElementById('date').value,
        remaining: parseInt(document.getElementById('qty').value) || 0,
        timestamp: Date.now()
      };
      tempOrders.push(newItem);
      renderOrderList();
      alert("æ³¨æ–‡ãƒªã‚¹ãƒˆã«è¿½åŠ ã—ã¾ã—ãŸï¼");
      document.querySelectorAll('#register input').forEach(el => el.value = "");
    }

    function renderOrderList() {
      const container = document.getElementById("orderListContainer");
      if (!container) return;

      if (tempOrders.length === 0) {
        container.innerHTML = "<p>ç¾åœ¨ã€æ³¨æ–‡æ¸ˆã¿ãƒªã‚¹ãƒˆã¯ç©ºã§ã™ã€‚</p>";
        return;
      }

      let html = "<table><thead><tr><th>ç™»éŒ²è€…</th><th>ãƒ¡ãƒ¼ã‚«ãƒ¼</th><th>ã‚«ãƒ†ã‚´ãƒª</th><th>å‹å¼</th><th>å€‹æ•°</th><th>ç¾å ´å</th><th>æ³¨æ–‡æ—¥</th><th>æ“ä½œ</th></tr></thead><tbody>";
    for (const key in data) {
      const item = data[key];
      const item_json = JSON.stringify(item).replace(/"/g, '&quot;');
      html += `<tr>
        <td>${item.user}</td>
        <td>${item.maker}</td>
        <td>${item.category}</td>
        <td>${item.model}</td>
        <td>${item.qty}</td>
        <td>${item.site}</td>
        <td>${item.date}</td>
        <td>
          <button onclick="confirmOrderFromFirebase('${key}', ${item_json})">ç™»éŒ²</button><br>
          <button onclick="sendToOrderFormFromFirebase(${item_json})">æ³¨æ–‡æ›¸ç™ºè¡Œ</button><br>
          <button onclick="deleteOrderFromFirebase('${key}')">å‰Šé™¤</button>
        </td>
      </tr>`;
    }
    html += "</tbody></table>";
    container.innerHTML = html;
    }

    function confirmOrder(index) {
      const item = tempOrders[index];
      dbRef.push(item);
      tempOrders.splice(index, 1);
      renderOrderList();
      alert("åœ¨åº«ã«ç™»éŒ²ã•ã‚Œã¾ã—ãŸï¼");
    }


function sendToOrderForm(index) {
  const item = tempOrders[index];
  localStorage.setItem("rinnaiOrderItem", JSON.stringify(item));
  window.location.href = "rinnai_order_form.html";
}

</script>
</head>
<body>
<h1>åœ¨åº«ç®¡ç†ï¼ˆFirebaseå¯¾å¿œï¼‰</h1>
<div class="tab">
<div class="tab">
</div>
<button onclick="switchTab('register')">å•†å“ç™»éŒ²</button>
<button onclick="switchTab('list')">ä¸€è¦§</button>
<button onclick="switchTab('used')">ä½¿ç”¨æ¸ˆã¿ä¸€è¦§</button>
</div>
<div class="section" id="register">
<h2>åœ¨åº«ç™»éŒ²</h2>
<select id="user"><option value="">ç™»éŒ²è€…é¸æŠ</option><option value="é˜¿éƒ¨">é˜¿éƒ¨</option><option value="éˆ´æœ¨">éˆ´æœ¨</option><option value="ç´ºé‡">ç´ºé‡</option><option value="äº€å²¡">äº€å²¡</option><option value="å¤§æ§»">å¤§æ§»</option><option value="é’ç”°">é’ç”°</option><option value="èŠç”°">èŠç”°</option><option value="é«˜æ©‹">é«˜æ©‹</option><option value="ä½è—¤">ä½è—¤</option></select>
<input id="maker" placeholder="ãƒ¡ãƒ¼ã‚«ãƒ¼" readonly="readonly" type="text" value="ãƒªãƒ³ãƒŠã‚¤"/>
<select id="category"><option value="ã‚¬ã‚¹çµ¦æ¹¯å™¨">ã‚¬ã‚¹çµ¦æ¹¯å™¨</option><option value="ã‚¬ã‚¹ç¬é–“æ¹¯æ²¸å™¨">ã‚¬ã‚¹ç¬é–“æ¹¯æ²¸å™¨</option><option value="ãƒªãƒ¢ã‚³ãƒ³">ãƒªãƒ¢ã‚³ãƒ³</option><option value="é…ç®¡ã‚«ãƒãƒ¼">é…ç®¡ã‚«ãƒãƒ¼</option></select>
<input id="model" placeholder="å‹å¼" type="text"/>
<input id="qty" placeholder="å€‹æ•°" type="number"/>
<input id="site" placeholder="ç¾å ´å" type="text"/>
<input id="date" type="date"/>
<button onclick="addInventory()">æ³¨æ–‡ã™ã‚‹</button>
<h3>æ³¨æ–‡æ¸ˆã¿ãƒªã‚¹ãƒˆ</h3>
<div id="orderListContainer">ã“ã“ã«æ³¨æ–‡ã—ãŸå•†å“ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</div>
</div>
<div class="section hidden" id="used">
<h2>ä½¿ç”¨æ¸ˆã¿åœ¨åº«ä¸€è¦§</h2>
<div id="usedContainer">ã“ã“ã«ä½¿ç”¨æ¸ˆã¿ä¸€è¦§ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</div>
</div>
<div class="section hidden" id="list">
<h2>åœ¨åº«ä¸€è¦§</h2>
<div class="table-scroll"><table>
<thead>
<tr><th>ç™»éŒ²è€…</th><th>ãƒ¡ãƒ¼ã‚«ãƒ¼</th><th>ã‚«ãƒ†ã‚´ãƒª</th><th>å‹å¼</th><th>å€‹æ•°</th><th>ç¾å ´å</th><th>æ³¨æ–‡æ—¥</th><th>æ“ä½œ</th></tr>
</thead>
<tbody id="inventoryBody"></tbody>
</table></div>
</div>
<script>
    const firebaseConfig = {
      apiKey: "AIzaSyARhO9hECPxXopKRBZrHBAkboqmCxY651i0",
      authDomain: "zaiko-app-54fa6.firebaseapp.com",
      databaseURL: "https://zaiko-app-54fa6-default-rtdb.firebaseio.com",
      projectId: "zaiko-app-54fa6",
      storageBucket: "zaiko-app-54fa6.appspot.com",
      messagingSenderId: "615970420186",
      appId: "1:615970420186:web:8eab3b94d70da28f5bce3"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const dbRef = db.ref("inventories");

    function switchTab(tabId) {
      document.getElementById('register').classList.add('hidden');
      document.getElementById('list').classList.add('hidden');
      document.getElementById('used').classList.add('hidden');

      // âœ… ä»–ã®ã‚¿ãƒ–ã‚’æŠ¼ã—ãŸã‚‰ä½¿ç”¨æ¸ˆã¿ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ãƒªã‚»ãƒƒãƒˆ
      if (tabId !== 'used') {
        const usedContainer = document.getElementById('usedContainer');
        if (usedContainer) usedContainer.innerHTML = "";
      }
      document.getElementById('list').classList.add('hidden');
      document.getElementById(tabId).classList.remove('hidden');
      if (tabId === 'list') renderInventory();
      if (tabId === 'used') renderUsedInventory();
    }

    function addInventory() {
      const newItem = {
        user: document.getElementById('user').value,
        maker: document.getElementById('maker').value,
        category: document.getElementById('category').value,
        model: document.getElementById('model').value,
        qty: parseInt(document.getElementById('qty').value) || 0,
        site: document.getElementById('site').value,
        date: document.getElementById('date').value,
        remaining: parseInt(document.getElementById('qty').value) || 0,
        timestamp: Date.now()
      };
      dbRef.push(newItem);
      alert("ç™»éŒ²ã—ã¾ã—ãŸï¼");
      document.querySelectorAll('#register input').forEach(el => el.value = "");
    }

    function renderInventory() {
      dbRef.once("value", snapshot => {
        const tbody = document.getElementById("inventoryBody");
        tbody.innerHTML = "";
        snapshot.forEach(child => {
          const item = child.val();
          if (item.remaining > 0) {
            const tr = document.createElement("tr");
            tr.innerHTML = `
              <td>${item.user}</td>
              <td>${item.maker}</td>
              <td>${item.category}</td>
              <td>${item.model}</td>
              <td>${item.remaining}</td>
              <td>${item.site}</td>
              <td>${item.date}</td>
              <td class="actions">
                <button onclick="useItem('${child.key}', ${item.remaining})">ä½¿ç”¨</button>
                <button onclick="deleteItem('${child.key}')">å‰Šé™¤</button>
              </td>
            `;
            tbody.appendChild(tr);
          }
        });
      });
    }

    function useItem(key, remaining) {
      if (remaining > 0) {
        dbRef.child(key).once("value").then(snapshot => {
          const item = snapshot.val();
          const usedRef = firebase.database().ref("usedReports");
          usedRef.push({
            user: item.user,
            maker: item.maker,
            category: item.category,
            model: item.model,
            qty: 1,
            site: item.site,
            date: new Date().toISOString().split("T")[0]
          });
        });
        dbRef.child(key).update({ remaining: remaining - 1 });
        renderInventory();
      }
    }

    function deleteItem(key) {
      dbRef.child(key).remove();
      renderInventory();
    }

    
    function renderUsedInventory() {
  const container = document.getElementById("usedContainer");
  container.innerHTML = "<p>ä½¿ç”¨æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...</p>";

  const usedRef = firebase.database().ref("usedReports");
  usedRef.once("value").then(snapshot => {
    const usedItems = snapshot.val();
    if (!usedItems) {
      container.innerHTML = "<p>ä½¿ç”¨æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>";
      return;
    }

    let html = `
    <div style='margin-bottom: 10px; text-align: right;'>
      <button onclick="toggleEditMode()">âœ ç·¨é›†</button>
      <button onclick="saveUsedPrices()">ğŸ“Œ ç´å…¥ä¾¡æ ¼ã‚’ä¿å­˜</button>
      <button id="deleteSelectedBtn" onclick="deleteSelectedUsed()" style="display:none;">âŒ é¸æŠå‰Šé™¤</button>
    </div>
    <table><thead>
    <tr>
      <th>ç™»éŒ²è€…</th>
      <th>å‹å¼</th>
      <th>ã‚«ãƒ†ã‚´ãƒª</th>
      <th>ä½¿ç”¨æ—¥</th>
      <th>ç´å…¥ä¾¡æ ¼</th>
      <th class="used-checkbox-col" style="display:none;">é¸æŠ</th>
    </tr></thead><tbody>`;

    Object.entries(usedItems).forEach(([key, item]) => {
      html += `
      <tr>
        <td>${item.user || ""}</td>
        <td>${item.model || ""}</td>
        <td>${item.category || ""}</td>
        <td>${item.date || ""}</td>
        <td><input type="text" class="used-price-input" data-key="${key}" value="${item.price || ''}" placeholder="0å††" style="width: 80px; text-align: right;"></td>
        <td class="used-checkbox-col" style="display:none;"><input type="checkbox" class="used-delete-check" data-key="${key}"></td>
      </tr>`;
    });

    html += "</tbody></table>";
    container.innerHTML = html;
  }).catch(error => {
    container.innerHTML = "<p>èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: " + error + "</p>";
  });
}


    window.addEventListener("DOMContentLoaded", () => {});
  
    const tempOrders = [];

    function addInventory() {
      const newItem = {
        user: document.getElementById('user').value,
        maker: document.getElementById('maker').value,
        category: document.getElementById('category').value,
        model: document.getElementById('model').value,
        qty: parseInt(document.getElementById('qty').value) || 0,
        site: document.getElementById('site').value,
        date: document.getElementById('date').value,
        remaining: parseInt(document.getElementById('qty').value) || 0,
        timestamp: Date.now()
      };
      tempOrders.push(newItem);
      renderOrderList();
      alert("æ³¨æ–‡ãƒªã‚¹ãƒˆã«è¿½åŠ ã—ã¾ã—ãŸï¼");
      document.querySelectorAll('#register input').forEach(el => el.value = "");
    }

    function renderOrderList() {
      const container = document.getElementById("orderListContainer");
      if (!container) return;

      if (tempOrders.length === 0) {
        container.innerHTML = "<p>ç¾åœ¨ã€æ³¨æ–‡æ¸ˆã¿ãƒªã‚¹ãƒˆã¯ç©ºã§ã™ã€‚</p>";
        return;
      }

      let html = "<table><thead><tr><th>ç™»éŒ²è€…</th><th>ãƒ¡ãƒ¼ã‚«ãƒ¼</th><th>ã‚«ãƒ†ã‚´ãƒª</th><th>å‹å¼</th><th>å€‹æ•°</th><th>ç¾å ´å</th><th>æ³¨æ–‡æ—¥</th><th>æ“ä½œ</th></tr></thead><tbody>";
    for (const key in data) {
      const item = data[key];
      const item_json = JSON.stringify(item).replace(/"/g, '&quot;');
      html += `<tr>
        <td>${item.user}</td>
        <td>${item.maker}</td>
        <td>${item.category}</td>
        <td>${item.model}</td>
        <td>${item.qty}</td>
        <td>${item.site}</td>
        <td>${item.date}</td>
        <td>
          <button onclick="confirmOrderFromFirebase('${key}', ${item_json})">ç™»éŒ²</button><br>
          <button onclick="sendToOrderFormFromFirebase(${item_json})">æ³¨æ–‡æ›¸ç™ºè¡Œ</button><br>
          <button onclick="deleteOrderFromFirebase('${key}')">å‰Šé™¤</button>
        </td>
      </tr>`;
    }
    html += "</tbody></table>";
    container.innerHTML = html;
    }

    function confirmOrder(index) {
      const item = tempOrders[index];
      dbRef.push(item);
      tempOrders.splice(index, 1);
      renderOrderList();
      alert("åœ¨åº«ã«ç™»éŒ²ã•ã‚Œã¾ã—ãŸï¼");
    }


function sendToOrderForm(index) {
  const item = tempOrders[index];
  localStorage.setItem("rinnaiOrderItem", JSON.stringify(item));
  window.location.href = "rinnai_order_form.html";
}

</script>
<script>
const tempOrdersRef = firebase.database().ref("tempOrders");

// ğŸ”„ ç™»éŒ²ãƒœã‚¿ãƒ³æŠ¼ã—ãŸæ™‚ã«Firebaseã¸ä¿å­˜
function addInventory() {
  const newItem = {
    user: document.getElementById('user').value,
    maker: document.getElementById('maker').value,
    category: document.getElementById('category').value,
    model: document.getElementById('model').value,
    qty: parseInt(document.getElementById('qty').value) || 0,
    site: document.getElementById('site').value,
    date: document.getElementById('date').value,
    remaining: parseInt(document.getElementById('qty').value) || 0,
    timestamp: Date.now()
  };
  tempOrdersRef.push(newItem);
  alert("æ³¨æ–‡ãƒªã‚¹ãƒˆã«è¿½åŠ ã—ã¾ã—ãŸï¼");
  document.querySelectorAll('#register input').forEach(el => el.value = "");
  renderOrderListFromFirebase();
}

// ğŸ” Firebaseã‹ã‚‰æ³¨æ–‡ãƒªã‚¹ãƒˆã‚’èª­ã¿è¾¼ã‚“ã§è¡¨ç¤º
function renderOrderListFromFirebase() {
  const container = document.getElementById("orderListContainer");
  if (!container) return;

  tempOrdersRef.once("value", snapshot => {
    const data = snapshot.val();
    if (!data) {
      container.innerHTML = "<p>ç¾åœ¨ã€æ³¨æ–‡æ¸ˆã¿ãƒªã‚¹ãƒˆã¯ç©ºã§ã™ã€‚</p>";
      return;
    }
    let html = "<table><thead><tr><th>ç™»éŒ²è€…</th><th>ãƒ¡ãƒ¼ã‚«ãƒ¼</th><th>ã‚«ãƒ†ã‚´ãƒª</th><th>å‹å¼</th><th>å€‹æ•°</th><th>ç¾å ´å</th><th>æ³¨æ–‡æ—¥</th><th>æ“ä½œ</th></tr></thead><tbody>";
    for (const key in data) {
      const item = data[key];
      const item_json = JSON.stringify(item).replace(/"/g, '&quot;');
      html += `<tr>
        <td>${item.user}</td>
        <td>${item.maker}</td>
        <td>${item.category}</td>
        <td>${item.model}</td>
        <td>${item.qty}</td>
        <td>${item.site}</td>
        <td>${item.date}</td>
        <td>
          <button onclick="confirmOrderFromFirebase('${key}', ${item_json})">ç™»éŒ²</button><br>
          <button onclick="sendToOrderFormFromFirebase(${item_json})">æ³¨æ–‡æ›¸ç™ºè¡Œ</button><br>
          <button onclick="deleteOrderFromFirebase('${key}')">å‰Šé™¤</button>
        </td>
      </tr>`;
    }
    html += "</tbody></table>";
    container.innerHTML = html;
  });
}

// âœ… æ³¨æ–‡æ¸ˆã¿ãƒªã‚¹ãƒˆã‹ã‚‰åœ¨åº«ã«ç™»éŒ² â†’ tempOrdersã‹ã‚‰å‰Šé™¤
function confirmOrderFromFirebase(key, item) {
  dbRef.push(item);
  tempOrdersRef.child(key).remove();
  renderOrderListFromFirebase();
  alert("åœ¨åº«ã«ç™»éŒ²ã•ã‚Œã¾ã—ãŸï¼");
}

// âœ… æ³¨æ–‡æ›¸ç™ºè¡Œç”¨ã« localStorage ã«ä¿å­˜ã—ã¦é·ç§»
function sendToOrderFormFromFirebase(item) {
  localStorage.setItem("rinnaiOrderItem", JSON.stringify(item));
  window.location.href = "rinnai_order_form.html";
}

// ğŸ” åˆæœŸè¡¨ç¤ºæ™‚ã«ãƒªã‚¹ãƒˆæç”»ï¼ˆDOMå®Œå…¨èª­ã¿è¾¼ã¿å¾Œï¼‰
window.addEventListener("DOMContentLoaded", () => {
  const checkInterval = setInterval(() => {
    const container = document.getElementById("orderListContainer");
    if (container) {
      clearInterval(checkInterval);
      renderOrderListFromFirebase();
    }
  }, 100);
});
</script>
<!-- âœ… ä¿®æ­£ãƒã‚§ãƒƒã‚¯é …ç›®ï¼ˆFirebaseä¿å­˜å°‚ç”¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ v4ï¼‰
1. å¤ã„ tempOrders = [] å‰Šé™¤æ¸ˆã¿: âœ…
2. addInventory() ã¯Firebase pushã«å®Œå…¨ç§»è¡Œ: âœ…
3. renderOrderList() â†’ renderOrderListFromFirebase() ã«çµ±ä¸€: âœ…
4. æ›´æ–°ã—ã¦ã‚‚æ³¨æ–‡ãƒªã‚¹ãƒˆãŒä¿æŒã•ã‚Œã‚‹æ§‹æˆ: âœ…
5. è¦‹ãŸç›®ãƒ»æ§‹é€ ã¯å®Œå…¨ç¶­æŒ: âœ…
-->
</body>
</html>
<!-- âœ… ä¿®æ­£ãƒã‚§ãƒƒã‚¯é …ç›®ä¸€è¦§
1. localStorage ã®æ®‹å­˜ãƒã‚§ãƒƒã‚¯: âŒ
2. usedLogs ã®æ®‹å­˜ãƒã‚§ãƒƒã‚¯: âŒ
3. reportUsed() ã« Firebase push() ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹: âœ…
4. ã‚³ãƒ¡ãƒ³ãƒˆï¼ˆå‰å›ã®å¤±æ•—ãƒ»ä»Šå›ã®ä¿®æ­£ï¼‰: âœ…
5. </html> ã‚¿ã‚°ã®å­˜åœ¨: âœ…
6. .filter(item => item.remaining > 0): âœ…
7. ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæ§‹é€ å¤‰æ›´ãªã—: âœ…
8. ã‚³ãƒ¼ãƒ‰é †åºå¤‰æ›´ãªã—: âœ…
å‰å›ã®å¤±æ•—: ä½¿ç”¨ãƒœã‚¿ãƒ³ã« Firebase push() ãŒãªã‹ã£ãŸ
ä»Šå›ã®ä¿®æ­£: useItem() å†…ã« usedReports.push() ã‚’è¿½åŠ ã—è¨˜éŒ²å¯¾å¿œæ¸ˆã¿
-->
<!-- âœ… ä¿®æ­£ãƒã‚§ãƒƒã‚¯é …ç›®ï¼ˆå†è¿½åŠ ï¼‰
1. localStorage ã®æ®‹å­˜ãƒã‚§ãƒƒã‚¯: âŒ
2. usedLogs ã®æ®‹å­˜ãƒã‚§ãƒƒã‚¯: âŒ
3. reportUsed() ã« Firebase push() ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹: âœ…
4. ã‚³ãƒ¡ãƒ³ãƒˆï¼ˆå‰å›ã®å¤±æ•—ãƒ»ä»Šå›ã®ä¿®æ­£ï¼‰: âœ…
5. </html> ã‚¿ã‚°ã®å­˜åœ¨: âœ…
6. .filter(item => item.remaining > 0): âœ…
7. ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæ§‹é€ å¤‰æ›´ãªã—: âœ…
8. ã‚³ãƒ¼ãƒ‰é †åºå¤‰æ›´ãªã—: âœ…
å‰å›ã®å¤±æ•—: ä¸€è¦§ã‚¿ãƒ–ä»¥å¤–ã§ã‚‚åœ¨åº«ä¸€è¦§ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ãŸï¼ˆrenderInventory ãŒå¸¸ã«èµ°ã£ã¦ã„ãŸï¼‰
ä»Šå›ã®ä¿®æ­£: DOMContentLoaded ã§ renderInventory ã‚’å‘¼ã°ãšã€switchTab çµŒç”±ã®ã¿ã«åˆ¶é™
-->
<!-- âœ… ä¿®æ­£ãƒã‚§ãƒƒã‚¯é …ç›®ï¼ˆæœ€çµ‚ç‰ˆï¼‰
1. localStorage ã®æ®‹å­˜ãƒã‚§ãƒƒã‚¯: âŒ
2. usedLogs ã®æ®‹å­˜ãƒã‚§ãƒƒã‚¯: âŒ
3. reportUsed() ã« Firebase push() ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹: âœ…
4. ã‚³ãƒ¡ãƒ³ãƒˆï¼ˆå‰å›ã®å¤±æ•—ãƒ»ä»Šå›ã®ä¿®æ­£ï¼‰: âœ…
5. </html> ã‚¿ã‚°ã®å­˜åœ¨: âœ…
6. .filter(item => item.remaining > 0): âœ…
7. ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæ§‹é€ å¤‰æ›´ãªã—: âœ…
8. ã‚³ãƒ¼ãƒ‰é †åºå¤‰æ›´ãªã—: âœ…
å‰å›ã®å¤±æ•—: ä½¿ç”¨æ¸ˆã¿ä¸€è¦§ã‚’è¦‹ãŸã‚ã¨ã€Œä¸€è¦§ã€ã«æˆ»ã‚‹ã¨è¡¨ç¤ºãŒæ®‹ã£ã¦ã—ã¾ã†
ä»Šå›ã®ä¿®æ­£: switchTab() å†…ã§ usedContainer ã®ä¸­èº«ã‚’ãƒªã‚»ãƒƒãƒˆã™ã‚‹ã‚ˆã†ã«å¯¾å¿œæ¸ˆã¿
-->
<!-- âœ… ä¿®æ­£ãƒã‚§ãƒƒã‚¯é …ç›®ï¼ˆæ³¨æ–‡â†’ä¸€æ™‚è¡¨ç¤ºâ†’ç™»éŒ²ãƒ•ãƒ­ãƒ¼ï¼‰
1. ç™»éŒ²ã¯ä¸€æ™‚ä¿å­˜ã•ã‚Œã€Œä¸‹ã®ä¸€è¦§ã€ã«è¡¨ç¤º: âœ…
2. ã€Œç™»éŒ²ã€ãƒœã‚¿ãƒ³ã§Firebaseã«push: âœ…
3. è¡¨ç¤ºã¯ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ï¼ˆrenderOrderListï¼‰: âœ…
4. ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãƒ»æ§‹é€ ã®é †åºå¤‰æ›´ãªã—: âœ…
5. æ—¢å­˜ addInventory é–¢æ•°ã®å‹•ä½œå¤‰æ›´æ¸ˆã¿: âœ…
-->
<!-- âœ… ä¿®æ­£ãƒã‚§ãƒƒã‚¯é …ç›®ï¼ˆæ³¨æ–‡æ›¸ã¸ã®é€ä¿¡æ©Ÿèƒ½è¿½åŠ ï¼‰
1. æ³¨æ–‡æ¸ˆã¿ãƒªã‚¹ãƒˆã«ã€Œæ³¨æ–‡æ›¸ã«é€ã‚‹ã€ãƒœã‚¿ãƒ³ãŒè¿½åŠ ã•ã‚ŒãŸ: âœ…
2. localStorage ã« JSON å½¢å¼ã§ä¿å­˜ã•ã‚Œã¦ã„ã‚‹: âœ…
3. rinnai_order_form.html ã«é·ç§»ã™ã‚‹å‡¦ç†ãŒå‹•ä½œ: âœ…
4. æ§‹é€ ãƒ»é †ç•ªãƒ»è¦‹ãŸç›®ã‚’ä¸€åˆ‡å´©ã•ãšç¶­æŒ: âœ…
-->
<script>

// âœ… æ³¨æ–‡æ¸ˆã¿ãƒªã‚¹ãƒˆã‹ã‚‰å‰Šé™¤
function deleteOrderFromFirebase(key) {
  if (confirm("æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ")) {
    const tempOrdersRef = firebase.database().ref("tempOrders");
    tempOrdersRef.child(key).remove();
    renderOrderListFromFirebase();
    alert("å‰Šé™¤ã—ã¾ã—ãŸï¼");
  }
}

</script>
<script>
// âœ… ä½¿ç”¨æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å‰Šé™¤
function deleteUsedReport(key) {
  if (confirm("æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ")) {
    const usedRef = firebase.database().ref("usedReports");
    usedRef.child(key).remove();
    renderUsedInventory();
    alert("ä½¿ç”¨æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã—ãŸï¼");
  }
}
</script>
<script>
let usedEditMode = false;

function toggleEditMode() {
  usedEditMode = !usedEditMode;
  document.querySelectorAll('.used-checkbox-col').forEach(el => {
    el.style.display = usedEditMode ? '' : 'none';
  });
  const btn = document.getElementById("deleteSelectedBtn");
  if (btn) btn.style.display = usedEditMode ? 'inline-block' : 'none';
}

function saveUsedPrices() {
  const inputs = document.querySelectorAll('.used-price-input');
  const updates = {};
  inputs.forEach(input => {
    const key = input.dataset.key;
    let value = input.value.replace(/[^\d]/g, '');
    value = value ? parseInt(value, 10).toLocaleString() + 'å††' : '';
    updates[key] = value;
  });

  const usedRef = firebase.database().ref("usedReports");
  Object.entries(updates).forEach(([key, price]) => {
    usedRef.child(key).update({ price });
  });

  alert("ç´å…¥ä¾¡æ ¼ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼");
}

function deleteSelectedUsed() {
  const checked = document.querySelectorAll('.used-delete-check:checked');
  if (!checked.length) return alert("å‰Šé™¤ã™ã‚‹é …ç›®ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“ï¼");
  if (!confirm("é¸æŠã—ãŸé …ç›®ã‚’å‰Šé™¤ã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ")) return;

  const usedRef = firebase.database().ref("usedReports");
  checked.forEach(cb => {
    const key = cb.dataset.key;
    usedRef.child(key).remove();
  });

  alert("å‰Šé™¤ã—ã¾ã—ãŸï¼");
  setTimeout(() => location.reload(), 800);
}
</script>
